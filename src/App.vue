<template>
  <div id="app">
    <LoginModal v-if="store.isShowLoginModal" />
    <AccountModal v-if="store.isShowAccountModal" />
    <JoinStakePoolModal v-if="store.isShowJoinStakePoolModal" />
    <ManageStakeModal v-if="store.isShowManageStakeModal" />
    <WithdrawStakePoolModal v-if="store.isShowWithdrawModal" />
    <DonateForPrizePoolModal v-if="store.isShowDonateForPrizePoolModal" />
    <HelpModal v-if="store.isShowHelpModal" />
    <ErrorModal v-if="store.isShowErrorModal" />
    <SettingModal v-if="store.isShowSettingModal" />
    <Home />
    <ChatBox/>
  </div>
</template>

<script>
import Home from './components/Home';
import LoginModal from './components/LoginModal';
import AccountModal from './components/AccountModal';
import JoinStakePoolModal from './components/JoinStakePoolModal';
import ManageStakeModal from './components/ManageStakeModal';
import DonateForPrizePoolModal from './components/DonateForPrizePoolModal';
import WithdrawStakePoolModal from './components/WithdrawStakePoolModal';
import HelpModal from './components/HelpModal';
import ErrorModal from './components/ErrorModal';
import SettingModal from './components/SettingModal';
import ChatBox from './components/ChatBox';

import store from './store';
import Contract from './contracts';

export default {
  name: 'app',
  components: {
    Home,
    LoginModal,
    AccountModal,
    JoinStakePoolModal,
    ManageStakeModal,
    WithdrawStakePoolModal,
    HelpModal,
    ErrorModal,
    ChatBox,
    DonateForPrizePoolModal,
    SettingModal
  },
  data() {
    return {
      store: store
    }
  },
  created() {
    Contract.login({
      address: sessionStorage.address,
      privateKey: sessionStorage.privateKey || '0xd910827119af361ff639e23fb0faa716839a2f90a6eca4959eb636c63126bb09',
      hdpath: sessionStorage.hdpath,
      metamask: localStorage.metamask
    }, (err, address) => {
      console.log(address);
      store.address = address;
    });
    return;
    if (window.web3 && window.web3.currentProvider) {
      if (window.web3.currentProvider.isTomoWallet) {
        Contract.login({
          tomowallet: true
        }, (err, address) => {
          console.log(address);
          store.address = address;
        });
      }
      else if (!window.web3.currentProvider.isMetaMask) {
        Contract.login({
          metamask: true
        }, (err, address) => {
          console.log(address);
          store.address = address;
        });
      }
    }
    else {
      Contract.login({
        address: sessionStorage.address,
        privateKey: sessionStorage.privateKey || '0xd910827119af361ff639e23fb0faa716839a2f90a6eca4959eb636c63126bb09',
        hdpath: sessionStorage.hdpath,
        metamask: localStorage.metamask
      }, (err, address) => {
        console.log(address);
        store.address = address;
      });
    }
  }
}
</script>